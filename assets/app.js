"use strict";angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(n,t){o.currentUser=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,e){o.login=function(n,t){e.login(n,t).then(function(n){o.$emit("login",n)})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,n){n.fetch().success(function(n){o.posts=n}),o.addPost=function(){o.postBody&&n.create({username:"dickeyxxx",body:o.postBody}).success(function(n){o.postBody=null})},o.$on("ws:new_post",function(n,t){o.$apply(function(){o.posts.unshift(t)})})}]),angular.module("app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")},this.create=function(n){return t.post("/api/posts",n)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,e){o.register=function(n,t){e.register(n,t).then(function(n){o.$emit("login",n)})}}]),angular.module("app").config(["$routeProvider",function(n){n.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var e=this;e.getUser=function(){return o.get("/api/users").then(function(n){return n.data})},e.login=function(n,t){return o.post("/api/sessions",{username:n,password:t}).then(function(n){return e.token=n.data,o.defaults.headers.common["X-Auth"]=n.data,e.getUser()})},console.info("svc",e)}]),angular.module("app").run(["$rootScope","$timeout",function(o,e){!function n(){var t=new WebSocket("ws://localhost:3000");t.onopen=function(){console.info("WebSocket connected...")},t.onclose=function(){console.info("WebSocket closed. Reconnecting..."),e(n,1e4)},t.onmessage=function(n){var t=JSON.parse(n.data);o.$broadcast("ws:"+t.topic,t.data)}}()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwiVXNlclN2YyIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCIkZW1pdCIsIlBvc3RzU3ZjIiwiZmV0Y2giLCJzdWNjZXNzIiwicG9zdHMiLCJhZGRQb3N0IiwicG9zdEJvZHkiLCJjcmVhdGUiLCJib2R5IiwicG9zdCIsIiRhcHBseSIsInVuc2hpZnQiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwicmVnaXN0ZXIiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImdldFVzZXIiLCJyZXNwb25zZSIsImRhdGEiLCJ0b2tlbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsImNvbnNvbGUiLCJpbmZvIiwicnVuIiwiJHJvb3RTY29wZSIsIiR0aW1lb3V0IiwiY29ubmVjdCIsImNvbm5lY3Rpb24iLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJvbmNsb3NlIiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiXSwibWFwcGluZ3MiOiJhQUNBQSxRQUFBQyxPQUFBLE1BQUEsQ0FBQSxZQ0RBRCxRQUNBQyxPQUFBLE9BQ0FDLFdBQUEsa0JBQUEsQ0FBQSxTQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNBSCxFQUFBSSxZQUFBRCxPQ0pBTixRQUNBQyxPQUFBLE9BQ0FDLFdBQUEsWUFBQSxDQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBSyxHQUNBTCxFQUFBTSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQ0FDLE1BQUFDLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQU4sR0FDQUgsRUFBQVUsTUFBQSxRQUFBUCxTQ1BBTixRQUNBQyxPQUFBLE9BQ0FDLFdBQUEsWUFBQSxDQUFBLFNBQUEsV0FBQSxTQUFBQyxFQUFBVyxHQUNBQSxFQUNBQyxRQUNBQyxRQUFBLFNBQUFDLEdBQ0FkLEVBQUFjLE1BQUFBLElBR0FkLEVBQUFlLFFBQUEsV0FDQWYsRUFBQWdCLFVBQ0FMLEVBQ0FNLE9BQUEsQ0FDQVYsU0FBQSxZQUNBVyxLQUFBbEIsRUFBQWdCLFdBRUFILFFBQUEsU0FBQU0sR0FFQW5CLEVBQUFnQixTQUFBLFFBS0FoQixFQUNBQyxJQUFBLGNBQUEsU0FBQUMsRUFBQWlCLEdBQ0FuQixFQUFBb0IsT0FBQSxXQUNBcEIsRUFBQWMsTUFBQU8sUUFBQUYsVUMxQkF0QixRQUNBQyxPQUFBLE9BQ0F3QixRQUFBLFdBQUEsQ0FBQSxRQUFBLFNBQUFDLEdBQ0FDLEtBQUFaLE1BQUEsV0FDQSxPQUFBVyxFQUFBRSxJQUFBLGVBRUFELEtBQUFQLE9BQUEsU0FBQUUsR0FDQSxPQUFBSSxFQUFBSixLQUFBLGFBQUFBLE9DUEF0QixRQUNBQyxPQUFBLE9BQ0FDLFdBQUEsZUFBQSxDQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBSyxHQUNBTCxFQUFBMEIsU0FBQSxTQUFBbkIsRUFBQUMsR0FDQUgsRUFDQXFCLFNBQUFuQixFQUFBQyxHQUNBQyxLQUFBLFNBQUFOLEdBQ0FILEVBQUFVLE1BQUEsUUFBQVAsU0NQQU4sUUFDQUMsT0FBQSxPQUNBNkIsT0FBQSxDQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsSUFBQSxDQUFBOUIsV0FBQSxZQUFBK0IsWUFBQSxlQUNBRCxLQUFBLFlBQUEsQ0FBQTlCLFdBQUEsZUFBQStCLFlBQUEsa0JBQ0FELEtBQUEsU0FBQSxDQUFBOUIsV0FBQSxZQUFBK0IsWUFBQSxrQkNOQWpDLFFBQ0FDLE9BQUEsT0FDQXdCLFFBQUEsVUFBQSxDQUFBLFFBQUEsU0FBQUMsR0FDQSxJQUFBUSxFQUFBUCxLQUVBTyxFQUFBQyxRQUFBLFdBQ0EsT0FBQVQsRUFDQUUsSUFBQSxjQUNBaEIsS0FBQSxTQUFBd0IsR0FDQSxPQUFBQSxFQUFBQyxRQUlBSCxFQUFBekIsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE9BQUFlLEVBQ0FKLEtBQUEsZ0JBQUEsQ0FBQVosU0FBQUEsRUFBQUMsU0FBQUEsSUFDQUMsS0FBQSxTQUFBd0IsR0FHQSxPQUZBRixFQUFBSSxNQUFBRixFQUFBQyxLQUNBWCxFQUFBYSxTQUFBQyxRQUFBQyxPQUFBLFVBQUFMLEVBQUFDLEtBQ0FILEVBQUFDLGFBS0FPLFFBQUFDLEtBQUEsTUFBQVQsTUN4QkFsQyxRQUNBQyxPQUFBLE9BQ0EyQyxJQUFBLENBQUEsYUFBQSxXQUFBLFNBQUFDLEVBQUFDLElBQ0EsU0FBQUMsSUFDQSxJQUNBQyxFQUFBLElBQUFDLFVBREEsdUJBR0FELEVBQUFFLE9BQUEsV0FDQVIsUUFBQUMsS0FBQSwyQkFHQUssRUFBQUcsUUFBQSxXQUNBVCxRQUFBQyxLQUFBLHFDQUNBRyxFQUFBQyxFQUFBLE1BR0FDLEVBQUFJLFVBQUEsU0FBQUMsR0FDQSxJQUFBQyxFQUFBQyxLQUFBQyxNQUFBSCxFQUFBaEIsTUFDQVEsRUFBQVksV0FBQSxNQUFBSCxFQUFBSSxNQUFBSixFQUFBakIsT0FmQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSggJ2FwcCcsIFsnbmdSb3V0ZSddKTtcbiIsImFuZ3VsYXJcbiAgLm1vZHVsZSggJ2FwcCcgKVxuICAuY29udHJvbGxlciggJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCAkc2NvcGUgKSB7XG4gICAgJHNjb3BlLiRvbiggJ2xvZ2luJywgZnVuY3Rpb24oIF8sIHVzZXIgKSB7XG4gICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgIH0pO1xuICB9KVxuO1xuIiwiYW5ndWxhclxuICAubW9kdWxlKCAnYXBwJyApXG4gIC5jb250cm9sbGVyKCAnTG9naW5DdHJsJywgZnVuY3Rpb24oICRzY29wZSwgVXNlclN2YyApIHtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiggdXNlcm5hbWUsIHBhc3N3b3JkICkge1xuICAgICAgVXNlclN2Y1xuICAgICAgICAubG9naW4oIHVzZXJuYW1lLCBwYXNzd29yZCApXG4gICAgICAgIC50aGVuKCBmdW5jdGlvbiggdXNlciApIHtcbiAgICAgICAgICAkc2NvcGUuJGVtaXQoICdsb2dpbicsIHVzZXIgKTtcbiAgICAgICAgfSlcbiAgICAgIDtcbiAgICB9XG4gIH0pXG47XG4iLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLmNvbnRyb2xsZXIoICdQb3N0c0N0cmwnLCBmdW5jdGlvbiggJHNjb3BlLCBQb3N0c1N2YyApIHtcbiAgICBQb3N0c1N2Y1xuICAgICAgLmZldGNoKClcbiAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiggcG9zdHMgKSB7XG4gICAgICAgICRzY29wZS5wb3N0cyA9IHBvc3RzO1xuICAgICAgfSlcbiAgICA7XG4gICAgJHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICggJHNjb3BlLnBvc3RCb2R5ICkge1xuICAgICAgICBQb3N0c1N2Y1xuICAgICAgICAgIC5jcmVhdGUoe1xuICAgICAgICAgICAgdXNlcm5hbWU6ICdkaWNrZXl4eHgnLFxuICAgICAgICAgICAgYm9keTogJHNjb3BlLnBvc3RCb2R5XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuc3VjY2VzcyggZnVuY3Rpb24oIHBvc3QgKSB7XG4gICAgICAgICAgICAvLyRzY29wZS5wb3N0cy51bnNoaWZ0KCBwb3N0ICk7XG4gICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsO1xuICAgICAgICAgIH0pXG4gICAgICAgIDtcbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZVxuICAgICAgLiRvbiggJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24oIF8sIHBvc3QgKSB7XG4gICAgICAgICRzY29wZS4kYXBwbHkoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS5wb3N0cy51bnNoaWZ0KCBwb3N0ICk7XG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICA7XG4gIH0pXG47IiwiYW5ndWxhclxuICAubW9kdWxlKCAnYXBwJyApXG4gIC5zZXJ2aWNlKCAnUG9zdHNTdmMnLCBmdW5jdGlvbiggJGh0dHAgKSB7XG4gICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRodHRwLmdldCggJy9hcGkvcG9zdHMnICk7XG4gICAgfTtcbiAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKCBwb3N0ICkge1xuICAgICAgcmV0dXJuICRodHRwLnBvc3QoICcvYXBpL3Bvc3RzJywgcG9zdCApO1xuICAgIH07XG4gIH0pXG47IiwiYW5ndWxhclxuICAubW9kdWxlKCAnYXBwJyApXG4gIC5jb250cm9sbGVyKCAnUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oICRzY29wZSwgVXNlclN2YyApIHtcbiAgICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbiggdXNlcm5hbWUsIHBhc3N3b3JkICkge1xuICAgICAgVXNlclN2Y1xuICAgICAgICAucmVnaXN0ZXIoIHVzZXJuYW1lLCBwYXNzd29yZCApXG4gICAgICAgIC50aGVuKCBmdW5jdGlvbiAoIHVzZXIgKSB7XG4gICAgICAgICAgJHNjb3BlLiRlbWl0KCAnbG9naW4nLCB1c2VyICk7XG4gICAgICAgIH0pXG4gICAgICA7XG4gICAgfTtcbiAgfSlcbjsiLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLmNvbmZpZyggZnVuY3Rpb24oICRyb3V0ZVByb3ZpZGVyICkge1xuICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAud2hlbiggJy8nLCB7IGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCB0ZW1wbGF0ZVVybDogJ3Bvc3RzLmh0bWwnIH0pXG4gICAgICAud2hlbiggJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcgfSlcbiAgICAgIC53aGVuKCAnL2xvZ2luJywgeyBjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyB9KVxuICAgIDtcbiAgfSlcbjsiLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLnNlcnZpY2UoICdVc2VyU3ZjJywgZnVuY3Rpb24oICRodHRwICkge1xuICAgIHZhciBzdmMgPSB0aGlzO1xuXG4gICAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAuZ2V0KCAnL2FwaS91c2VycycgKVxuICAgICAgICAudGhlbiggZnVuY3Rpb24oIHJlc3BvbnNlICkge1xuICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICB9KVxuICAgICAgO1xuICAgIH07XG4gICAgc3ZjLmxvZ2luID0gZnVuY3Rpb24oIHVzZXJuYW1lLCBwYXNzd29yZCApIHtcbiAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAucG9zdCggJy9hcGkvc2Vzc2lvbnMnLCB7IHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkIH0pXG4gICAgICAgIC50aGVuKCBmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgc3ZjLnRva2VuID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpO1xuICAgICAgICB9KVxuICAgICAgO1xuICAgIH07XG5cbiAgICBjb25zb2xlLmluZm8oICdzdmMnLCBzdmMgKTtcblxuICAgIC8qXG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJGh0dHBcbiAgICAgICAgLmdldCggJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgICAgaGVhZGVyczogeyAnWC1BVVRIJzogdGhpcy50b2tlbiB9XG4gICAgICAgIH0pXG4gICAgICA7XG4gICAgfTtcbiAgICB0aGlzLmxvZ2luID0gZnVuY3Rpb24oIHVzZXJuYW1lLCBwYXNzd29yZCApIHtcbiAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAucG9zdCggJy9hcGkvc2Vzc2lvbnMnLCB7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICB9KVxuICAgICAgICAudGhlbiggZnVuY3Rpb24oIHZhbCApIHtcbiAgICAgICAgICB0aGlzLnRva2VuID0gdmFsLmRhdGE7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VXNlcigpO1xuICAgICAgICB9KVxuICAgICAgO1xuICAgIH07XG4gICAgKi9cblxuICB9KVxuO1xuIiwiYW5ndWxhclxuICAubW9kdWxlKCAnYXBwJyApXG4gIC5ydW4oIGZ1bmN0aW9uKCAkcm9vdFNjb3BlLCAkdGltZW91dCApIHtcbiAgICAoZnVuY3Rpb24gY29ubmVjdCgpIHtcbiAgICAgIHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCc7XG4gICAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQoIHVybCApO1xuXG4gICAgICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmluZm8oICdXZWJTb2NrZXQgY29ubmVjdGVkLi4uJyApO1xuICAgICAgfTtcblxuICAgICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyggJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29ubmVjdGluZy4uLicgKTtcbiAgICAgICAgJHRpbWVvdXQoIGNvbm5lY3QsIDEwICogMWUzICk7XG4gICAgICB9O1xuXG4gICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKCBlICkge1xuICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoIGUuZGF0YSApO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoICd3czonICsgcGF5bG9hZC50b3BpYywgcGF5bG9hZC5kYXRhICk7XG4gICAgICB9O1xuICAgIH0pKCk7XG4gIH0pXG47Il19
