"use strict";angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(t,n){o.currentUser=n})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(o,e,r){o.login=function(t,n){e.login(t,n).then(function(t){o.$emit("login",t),r.path("/")})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,t){t.fetch().then(function(t){o.posts=t}),o.addPost=function(){o.postBody&&t.create({username:"dickeyxxx",body:o.postBody}).then(function(t){o.postBody=null})},o.$on("ws:new_post",function(t,n){o.$apply(function(){o.posts.unshift(n)})})}]),angular.module("app").service("PostsSvc",["$http",function(n){this.fetch=function(){return n.get("/api/posts")},this.create=function(t){return n.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,e){o.register=function(t,n){e.register(t,n).then(function(t){o.$emit("login",t)})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var e=this;e.getUser=function(){return o.get("/api/users").then(function(t){return t.data})},e.login=function(t,n){return o.post("/api/sessions",{username:t,password:n}).then(function(t){return e.token=t.data,o.defaults.headers.common["X-Auth"]=t.data,e.getUser()})},console.info("svc",e)}]),angular.module("app").run(["$rootScope","$timeout","$location",function(e,r,s){!function t(){var n="ws://"+s.host()+":"+s.port(),o=new WebSocket(n);o.onopen=function(){console.info("WebSocket connected...")},o.onclose=function(){console.info("WebSocket closed. Reconnecting..."),r(t,1e4)},o.onmessage=function(t){var n=JSON.parse(t.data);e.$broadcast("ws:"+n.topic,n.data)}}()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwiVXNlclN2YyIsIiRsb2NhdGlvbiIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCIkZW1pdCIsInBhdGgiLCJQb3N0c1N2YyIsImZldGNoIiwicG9zdHMiLCJhZGRQb3N0IiwicG9zdEJvZHkiLCJjcmVhdGUiLCJib2R5IiwicG9zdCIsIiRhcHBseSIsInVuc2hpZnQiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwicmVnaXN0ZXIiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImdldFVzZXIiLCJyZXNwb25zZSIsImRhdGEiLCJ0b2tlbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsImNvbnNvbGUiLCJpbmZvIiwicnVuIiwiJHJvb3RTY29wZSIsIiR0aW1lb3V0IiwiY29ubmVjdCIsInVybCIsImhvc3QiLCJwb3J0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9uY2xvc2UiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyJdLCJtYXBwaW5ncyI6ImFBQ0FBLFFBQUFDLE9BQUEsTUFBQSxDQUFBLFlDREFELFFBQ0FDLE9BQUEsT0FDQUMsV0FBQSxrQkFBQSxDQUFBLFNBQUEsU0FBQUMsR0FDQUEsRUFBQUMsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLFlBQUFELE9DSkFOLFFBQ0FDLE9BQUEsT0FDQUMsV0FBQSxZQUFBLENBQUEsU0FBQSxVQUFBLFlBQUEsU0FBQUMsRUFBQUssRUFBQUMsR0FDQU4sRUFBQU8sTUFBQSxTQUFBQyxFQUFBQyxHQUNBSixFQUNBRSxNQUFBQyxFQUFBQyxHQUNBQyxLQUFBLFNBQUFQLEdBQ0FILEVBQUFXLE1BQUEsUUFBQVIsR0FDQUcsRUFBQU0sS0FBQSxXQ1JBZixRQUNBQyxPQUFBLE9BQ0FDLFdBQUEsWUFBQSxDQUFBLFNBQUEsV0FBQSxTQUFBQyxFQUFBYSxHQUNBQSxFQUNBQyxRQUNBSixLQUFBLFNBQUFLLEdBQ0FmLEVBQUFlLE1BQUFBLElBR0FmLEVBQUFnQixRQUFBLFdBQ0FoQixFQUFBaUIsVUFDQUosRUFDQUssT0FBQSxDQUNBVixTQUFBLFlBQ0FXLEtBQUFuQixFQUFBaUIsV0FFQVAsS0FBQSxTQUFBVSxHQUVBcEIsRUFBQWlCLFNBQUEsUUFLQWpCLEVBQ0FDLElBQUEsY0FBQSxTQUFBQyxFQUFBa0IsR0FDQXBCLEVBQUFxQixPQUFBLFdBQ0FyQixFQUFBZSxNQUFBTyxRQUFBRixVQzFCQXZCLFFBQ0FDLE9BQUEsT0FDQXlCLFFBQUEsV0FBQSxDQUFBLFFBQUEsU0FBQUMsR0FDQUMsS0FBQVgsTUFBQSxXQUNBLE9BQUFVLEVBQUFFLElBQUEsZUFFQUQsS0FBQVAsT0FBQSxTQUFBRSxHQUNBLE9BQUFJLEVBQUFKLEtBQUEsYUFBQUEsT0NQQXZCLFFBQ0FDLE9BQUEsT0FDQUMsV0FBQSxlQUFBLENBQUEsU0FBQSxVQUFBLFNBQUFDLEVBQUFLLEdBQ0FMLEVBQUEyQixTQUFBLFNBQUFuQixFQUFBQyxHQUNBSixFQUNBc0IsU0FBQW5CLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQVAsR0FDQUgsRUFBQVcsTUFBQSxRQUFBUixTQ1BBTixRQUNBQyxPQUFBLE9BQ0E4QixPQUFBLENBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxJQUFBLENBQUEvQixXQUFBLFlBQUFnQyxZQUFBLGVBQ0FELEtBQUEsWUFBQSxDQUFBL0IsV0FBQSxlQUFBZ0MsWUFBQSxrQkFDQUQsS0FBQSxTQUFBLENBQUEvQixXQUFBLFlBQUFnQyxZQUFBLGtCQ05BbEMsUUFDQUMsT0FBQSxPQUNBeUIsUUFBQSxVQUFBLENBQUEsUUFBQSxTQUFBQyxHQUNBLElBQUFRLEVBQUFQLEtBRUFPLEVBQUFDLFFBQUEsV0FDQSxPQUFBVCxFQUNBRSxJQUFBLGNBQ0FoQixLQUFBLFNBQUF3QixHQUNBLE9BQUFBLEVBQUFDLFFBSUFILEVBQUF6QixNQUFBLFNBQUFDLEVBQUFDLEdBQ0EsT0FBQWUsRUFDQUosS0FBQSxnQkFBQSxDQUFBWixTQUFBQSxFQUFBQyxTQUFBQSxJQUNBQyxLQUFBLFNBQUF3QixHQUdBLE9BRkFGLEVBQUFJLE1BQUFGLEVBQUFDLEtBQ0FYLEVBQUFhLFNBQUFDLFFBQUFDLE9BQUEsVUFBQUwsRUFBQUMsS0FDQUgsRUFBQUMsYUFLQU8sUUFBQUMsS0FBQSxNQUFBVCxNQ3hCQW5DLFFBQ0FDLE9BQUEsT0FDQTRDLElBQUEsQ0FBQSxhQUFBLFdBQUEsWUFBQSxTQUFBQyxFQUFBQyxFQUFBdEMsSUFDQSxTQUFBdUMsSUFDQSxJQUFBQyxFQUFBLFFBQUF4QyxFQUFBeUMsT0FBQSxJQUFBekMsRUFBQTBDLE9BQ0FDLEVBQUEsSUFBQUMsVUFBQUosR0FFQUcsRUFBQUUsT0FBQSxXQUNBWCxRQUFBQyxLQUFBLDJCQUdBUSxFQUFBRyxRQUFBLFdBQ0FaLFFBQUFDLEtBQUEscUNBQ0FHLEVBQUFDLEVBQUEsTUFHQUksRUFBQUksVUFBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFDLEtBQUFDLE1BQUFILEVBQUFuQixNQUNBUSxFQUFBZSxXQUFBLE1BQUFILEVBQUFJLE1BQUFKLEVBQUFwQixPQWZBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCAnYXBwJywgWyduZ1JvdXRlJ10pO1xuIiwiYW5ndWxhclxuICAubW9kdWxlKCAnYXBwJyApXG4gIC5jb250cm9sbGVyKCAnQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oICRzY29wZSApIHtcbiAgICAkc2NvcGUuJG9uKCAnbG9naW4nLCBmdW5jdGlvbiggXywgdXNlciApIHtcbiAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgfSk7XG4gIH0pXG47XG4iLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLmNvbnRyb2xsZXIoICdMb2dpbkN0cmwnLCBmdW5jdGlvbiggJHNjb3BlLCBVc2VyU3ZjLCAkbG9jYXRpb24gKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oIHVzZXJuYW1lLCBwYXNzd29yZCApIHtcbiAgICAgIFVzZXJTdmNcbiAgICAgICAgLmxvZ2luKCB1c2VybmFtZSwgcGFzc3dvcmQgKVxuICAgICAgICAudGhlbiggZnVuY3Rpb24oIHVzZXIgKSB7XG4gICAgICAgICAgJHNjb3BlLiRlbWl0KCAnbG9naW4nLCB1c2VyICk7XG4gICAgICAgICAgJGxvY2F0aW9uLnBhdGgoICcvJyApO1xuICAgICAgICB9KVxuICAgICAgO1xuICAgIH1cbiAgfSlcbjtcbiIsImFuZ3VsYXJcbiAgLm1vZHVsZSggJ2FwcCcgKVxuICAuY29udHJvbGxlciggJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uKCAkc2NvcGUsIFBvc3RzU3ZjICkge1xuICAgIFBvc3RzU3ZjXG4gICAgICAuZmV0Y2goKVxuICAgICAgLnRoZW4oIGZ1bmN0aW9uKCBwb3N0cyApIHtcbiAgICAgICAgJHNjb3BlLnBvc3RzID0gcG9zdHM7XG4gICAgICB9KVxuICAgIDtcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCAkc2NvcGUucG9zdEJvZHkgKSB7XG4gICAgICAgIFBvc3RzU3ZjXG4gICAgICAgICAgLmNyZWF0ZSh7XG4gICAgICAgICAgICB1c2VybmFtZTogJ2RpY2tleXh4eCcsXG4gICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKCBmdW5jdGlvbiggcG9zdCApIHtcbiAgICAgICAgICAgIC8vJHNjb3BlLnBvc3RzLnVuc2hpZnQoIHBvc3QgKTtcbiAgICAgICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGw7XG4gICAgICAgICAgfSlcbiAgICAgICAgO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlXG4gICAgICAuJG9uKCAnd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbiggXywgcG9zdCApIHtcbiAgICAgICAgJHNjb3BlLiRhcHBseSggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQoIHBvc3QgKTtcbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgIDtcbiAgfSlcbjsiLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLnNlcnZpY2UoICdQb3N0c1N2YycsIGZ1bmN0aW9uKCAkaHR0cCApIHtcbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCAnL2FwaS9wb3N0cycgKTtcbiAgICB9O1xuICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24oIHBvc3QgKSB7XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCggJy9hcGkvcG9zdHMnLCBwb3N0ICk7XG4gICAgfTtcbiAgfSlcbjsiLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLmNvbnRyb2xsZXIoICdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiggJHNjb3BlLCBVc2VyU3ZjICkge1xuICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKCB1c2VybmFtZSwgcGFzc3dvcmQgKSB7XG4gICAgICBVc2VyU3ZjXG4gICAgICAgIC5yZWdpc3RlciggdXNlcm5hbWUsIHBhc3N3b3JkIClcbiAgICAgICAgLnRoZW4oIGZ1bmN0aW9uICggdXNlciApIHtcbiAgICAgICAgICAkc2NvcGUuJGVtaXQoICdsb2dpbicsIHVzZXIgKTtcbiAgICAgICAgfSlcbiAgICAgIDtcbiAgICB9O1xuICB9KVxuOyIsImFuZ3VsYXJcbiAgLm1vZHVsZSggJ2FwcCcgKVxuICAuY29uZmlnKCBmdW5jdGlvbiggJHJvdXRlUHJvdmlkZXIgKSB7XG4gICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgIC53aGVuKCAnLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcbiAgICAgIC53aGVuKCAnL3JlZ2lzdGVyJywgeyBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyB9KVxuICAgICAgLndoZW4oICcvbG9naW4nLCB7IGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnIH0pXG4gICAgO1xuICB9KVxuOyIsImFuZ3VsYXJcbiAgLm1vZHVsZSggJ2FwcCcgKVxuICAuc2VydmljZSggJ1VzZXJTdmMnLCBmdW5jdGlvbiggJGh0dHAgKSB7XG4gICAgdmFyIHN2YyA9IHRoaXM7XG5cbiAgICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgIC5nZXQoICcvYXBpL3VzZXJzJyApXG4gICAgICAgIC50aGVuKCBmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIH0pXG4gICAgICA7XG4gICAgfTtcbiAgICBzdmMubG9naW4gPSBmdW5jdGlvbiggdXNlcm5hbWUsIHBhc3N3b3JkICkge1xuICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgIC5wb3N0KCAnL2FwaS9zZXNzaW9ucycsIHsgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmQgfSlcbiAgICAgICAgLnRoZW4oIGZ1bmN0aW9uKCByZXNwb25zZSApIHtcbiAgICAgICAgICBzdmMudG9rZW4gPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKCk7XG4gICAgICAgIH0pXG4gICAgICA7XG4gICAgfTtcblxuICAgIGNvbnNvbGUuaW5mbyggJ3N2YycsIHN2YyApO1xuXG4gICAgLypcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAuZ2V0KCAnL2FwaS91c2VycycsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7ICdYLUFVVEgnOiB0aGlzLnRva2VuIH1cbiAgICAgICAgfSlcbiAgICAgIDtcbiAgICB9O1xuICAgIHRoaXMubG9naW4gPSBmdW5jdGlvbiggdXNlcm5hbWUsIHBhc3N3b3JkICkge1xuICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgIC5wb3N0KCAnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCBmdW5jdGlvbiggdmFsICkge1xuICAgICAgICAgIHRoaXMudG9rZW4gPSB2YWwuZGF0YTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRVc2VyKCk7XG4gICAgICAgIH0pXG4gICAgICA7XG4gICAgfTtcbiAgICAqL1xuXG4gIH0pXG47XG4iLCJhbmd1bGFyXG4gIC5tb2R1bGUoICdhcHAnIClcbiAgLnJ1biggZnVuY3Rpb24oICRyb290U2NvcGUsICR0aW1lb3V0LCAkbG9jYXRpb24gKSB7XG4gICAgKGZ1bmN0aW9uIGNvbm5lY3QoKSB7XG4gICAgICB2YXIgdXJsID0gJ3dzOi8vJyArICRsb2NhdGlvbi5ob3N0KCkgKyAnOicgKyAkbG9jYXRpb24ucG9ydCgpO1xuICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KCB1cmwgKTtcblxuICAgICAgY29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5pbmZvKCAnV2ViU29ja2V0IGNvbm5lY3RlZC4uLicgKTtcbiAgICAgIH07XG5cbiAgICAgIGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmluZm8oICdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbm5lY3RpbmcuLi4nICk7XG4gICAgICAgICR0aW1lb3V0KCBjb25uZWN0LCAxMCAqIDFlMyApO1xuICAgICAgfTtcblxuICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiggZSApIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKCBlLmRhdGEgKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCAnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSApO1xuICAgICAgfTtcbiAgICB9KSgpO1xuICB9KVxuOyJdfQ==
